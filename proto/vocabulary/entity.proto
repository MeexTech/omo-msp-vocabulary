syntax = "proto3";

package omo.msp.vocabulary;
option go_package= "proto/vocabulary";
import "proto/vocabulary/common.proto";

service EntityService{
    rpc AddOne(ReqEntityAdd) returns (ReplyEntityOne) {}
    rpc GetOne(RequestInfo) returns (ReplyEntityOne) {}
    rpc RemoveOne(RequestInfo) returns (ReplyInfo) {}
    rpc GetListByOwner(ReqEntityBy) returns (ReplyEntityList) {}
    rpc UpdateBase(ReqEntityBase) returns (ReplyInfo) {}
    rpc UpdateStatus(ReqEntityStatus) returns (ReplyEntityStatus) {}
    rpc UpdateTags(ReqEntityUpdate) returns (ReplyEntityUpdate) {}
    rpc UpdateSynonyms(ReqEntityUpdate) returns (ReplyEntityUpdate) {}
    rpc AppendAsset(RequestInfo) returns (ReplyEntityAsset) {}
    rpc SubtractAsset(RequestInfo) returns (ReplyEntityAsset) {}
    rpc AppendProperty(ReqEntityProperty) returns (ReplyEntityProperties) {}
    rpc SubtractProperty(RequestInfo) returns (ReplyEntityProperties) {}
}

enum EntityStatus {
    Idle = 0;
    Pending = 1;
    Usable = 2;
    Failed = 3;
}

message EntityInfo {
    string uid = 1;
    string name = 2;
    string owner = 3;
    string cover = 4;
    string concept = 5;
    string description = 6;
    string add = 7;
    int64 time = 8;
    int64 updated = 9;
    int64 created = 10;
    repeated string synonyms = 11;
    repeated string tags = 12;
    repeated string assets = 13;
    repeated PropertyInfo properties = 14;
}

message PropertyInfo {
    string key = 1;
    repeated WordInfo words = 2;
}

message WordInfo {
    string uid = 1;
    string name = 2;
}

message ReqEntityAdd {
    string creator = 1;
    string name = 2;
    string owner = 3;
    string cover = 4;
    string concept = 5;
    string description = 6;
    string add = 7;
    repeated string synonyms = 8;
    repeated string tags = 9;
}

message ReqEntityBy {
    uint32 status = 1;
    string owner = 2;
}

message ReplyEntityOne {
    EntityInfo info = 1;
    ResultStatus errorCode = 2;
}

message ReplyEntityList {
    string flag = 1;
    repeated EntityInfo list = 2;
}

message ReqEntityProperty {
    string uid = 1;
    PropertyInfo property = 2;
}

message ReplyEntityProperties {
    string uid = 1;
    repeated PropertyInfo properties = 2;
    ResultStatus errorCode = 3;
}

message ReqEntityBase {
    string uid = 1;
    string name = 2;
    string desc = 3;
    string add = 4;
    string concept = 5;
    string cover = 6;
}

message ReqEntityStatus {
    string uid = 1;
    EntityStatus status = 2;
}

message ReplyEntityStatus {
    string uid = 1;
    EntityStatus status = 2;
    ResultStatus errorCode = 3;
}

message ReqEntityUpdate {
    string uid = 1;
    repeated string list = 2;
}

message ReplyEntityUpdate {
    string uid = 1;
    repeated string list = 2;
    ResultStatus errorCode = 3;
}

message ReplyEntityAsset {
    string uid = 1;
    repeated string assets = 2;
    ResultStatus errorCode = 3;
}


